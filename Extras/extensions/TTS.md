# TTS

SillyTavern has a wide range of TTS options. This page explains the setup and use.

### What is it?

TTS is used to have a voice narrate parts of your chat.

### Configuring TTS

#### TTS Provider Selectbox

Used to select which TTS service you want to use.

- **ElevenLabs** - paid subscription required, highest quality voices available at present.
- **Silero** - free, runs on your PC, quality can vary widely
- **System** - uses your OS TTS engine, if one exists. Quality can vary widely depending on the OS.
- **Edge** - free, runs via Azure, generally quite fast, and voices feel natural but dry and emotionless. Like listening to the evening news or a radio announcer.
- **Coqui-TTS** - free, No API Implementation at this time. High-performance Text2Speech models (Tacotron, Tacotron2, Glow-TTS, SpeedySpeech) as well as Bark.
- **Novel** - requires a paid NovelAI subscription, generated by NovelAI's TTS engine
- **RVC** - free, voice cloning

#### Checkboxes

- **Enabled** - turns TTS playback on/off
- **Auto Generation** - lets TTS start playing automatically when a new message enters the chat
- **Only narrate "quotes"** - Limits TTS playback to only include text within `"quotation marks"`. This will `*include "quotes" within asterisk lines*` (internal variable name = `narrate_quoted_only`)
- **Ignore \*text, even "quotes", inside asterisks\*** - TTS will not play any text within `*asterisks*`, even "quotes" (internal variable name = `narrate_dialogues_only`)
- *having both "only narrate quotes" and "ignore asterisks" checkboxes both checked will result in the TTS only reading "quotes" which are not in asterisks, and ignoring everything else.*
- **Narrate only the translated text** - this will make the TTS only narrate the translated text.

Given the example text: `*Cohee approaches you with a faint "nya"* "Good evening, senpai", she says.`
Here's a table showing how the text will be modified based on the boolean states of **Ignore \*text, even "quotes", inside asterisks\*** and **Only narrate "quotes"**:

| **Ignore \*text, even "quotes", inside asterisks\*** 	| **Only narrate "quotes"**	| **Output**                                                                   |
| :---------------------------------------------------- | :------------------------ | :--------------------------------------------------------------------------- | 
| Disabled                                              |	Disabled	                 | Cohee approaches you with a faint "nya" "Good evening, senpai", she says.    |
| Disabled                                              | Enabled	                  | "nya"... "Good evening, senpai"                                              |
| Enabled	                                              | Disabled	                 | "Good evening, senpai", she says.                                            |
| Enabled	                                              | Enabled	                  | "Good evening, senpai"                                                       |

#### Sliders

These will change depending on the API you select.

(explanation coming soon)

#### Buttons

- **Apply** - this must be clicked after setting a TTS API and after editing the voice map.
- **Available voices** - loads a popup with all voices available for your selected API, and lets you preview them with sample dialogues.

### Using TTS

1. Click the "Enable" checkbox, or nothing will ever happen.
2. Click the "Auto-generation" checkbox if you want the TTS to start automatically every time a new message arrives in chat.
3. Optionally, click the megaphone icon inside the top-right of any message to playback on demand.
4. Click the lower right "Stop" button (found inside the wand menu) to stop any playback.

#### Voice Map

You must provide a voice map for the TTS to use, otherwise, it won't know what voices should be used for each character.

These must be in the exact format stated below:

`CharacterName:TTSVoice,CharacterName2:TTSVoice2`

For Coqui-TTS the format needs to include the speaker and language from the WebGUI:

`CharacterName:TTSVoice[speakerid][langid]`
 or
`Aqua:tts_models--multilingual--multi-dataset--your_tts\model_file.pth[2][1]`

#### Bark ZeroShot Voice Cloning Speakers

If using Bark you must create a voice folder with a voice file to clone. Ensure you add voices to homedir\tts\bark_v0\speakers\. On Windows it is probably C:\Users\USERACCOUNT\AppData\Local\tts\bark_v0\speakers\ type %appdata% in windows explorer then go UP a directory to local and you should see tts.

The directory should look like this:
- homedir
  - tts
    - bark_v0
      - speakers
        - customvoice1
          - speaker.wav
          - speaker.npz
        - robinwilliams
          - speaker.mp3
        - me
          - speaker.mp3

One first load of this model and voice bark will clone the voice and create a .npz file, this is needed for faster TTS.

#### RVC Setup

PREREQUISITES:

- `sillytavern-extras`: Switch to the `neo` branch
- `sillytavern`: Switch to the `staging` branch

1. In a file browser navigate to **\SillyTavern-extras\data\models\rvc**, create a subfolder and put **.pth** and **.index** into the created folder
2. Install requirements with: `pip install -r requirements-rvc.txt`
3. Run SillyTavern-extras with an RVC module enabled (add other models and parameters if needed):
```yaml
python server.py --enable-modules=rvc
```
4. In SillyTavern, go to **Extensions --> RVC** and enable it
5. Setup a Voice map for RVC: read the instructions for TTS above, but instead of TTS voices, use RVC model folder names
6. Select pitch extraction: **rmvpe**
7. Go to **Extensions --> TTS** and enable it
8. Select TTS Provider: **Coqui** or your other preferred provider, but not **System** - RVC doesn't work with it. **ElevenLabs** is not recommended since it has its own voice cloning capabilities
9. Enable **Auto Generation**

#### Train your own RVC model

##### RVC Easy Menu by Deffcolony (only for Windows).

Automatically install and launch Mangio-RVC: https://github.com/deffcolony/rvc-easy-menu

1. Choose a location where you want to git clone the repo because RVC will install in the same location where you launch the script:
`git clone https://github.com/deffcolony/rvc-easy-menu.git`
2. Open RVC-Launcher.bat
3. Choose 1 since you want to install RVC.
4. When 7-zip pops up just, click install because it's a requirement for the 7z package that will get extracted automatically.
5. After installation when the menu returns choose 2 to open WebUI for Voice Training.

##### Mangio-RVC - Train a voice model

Dataset preparation:

1. Put the voice you want to train in the `datasets` folder.
2. Make sure there is NO BACKGROUND NOISE in the audio file; only raw voice!
3. The output quality will be better the longer the audio.

In the WebUI:

1. Click on the training tab
2. Enter the experiment name, for example, `my-epic-voice-model`
3. Set version to v2
4. Click on "Process data"
5. Click on "Feature extraction"
6. Set "Save frequency" to 50
7. Set "Total training epochs" to 300
8. Click on "Train feature index"
9. Click on "Train model"
